pipeline {
  options {
   timeout(time: 10, unit: 'MINUTES')
  }
  agent {
    node {
     label 'maven' 
    }
  }
  
  environment {
   PRO = "jentry2"
   APP = "myjen"
  }
  
  stages {
    stage('Build') {
      steps {
       echo "** Building" 
       echo "Project: ${PRO}"
        sh '''
        ls -lrt
        cd jentry
        oc delete all -l app=${APP}
        oc delete all -l build=${APP}
        mvn -s settings.xml package
        oc new-build --name ${APP} java:8 --binary=true -n ${PRO}
        oc start-build --from-file=jentry/target/${APP}.jar
        
        '''
      }
    }
    
    stage('Test') {
      steps {
       echo "** Testing" 
      }
    }
    
    stage('Deploy') {
      steps {
       echo "** Deploying" 
      }
    }
  }
}
